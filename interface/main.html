<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<link rel="icon" href="https://static.jianshukeji.com/hcode/images/favicon.ico">
	
	<style>#container {
		min-width: 380;
		max-width: 800px;
		margin: 0 auto;
	}
	</style>	
	<script src="https://img.hcharts.cn/highcharts/highcharts.js"></script>
	<script src="https://img.hcharts.cn/highcharts/modules/exporting.js"></script>
	<script src="https://img.hcharts.cn/highcharts/modules/boost.js"></script>
	<script src="https://img.hcharts.cn/highcharts/modules/boost-canvas.js"></script>
	<script src="https://img.hcharts.cn/highcharts-plugins/highcharts-zh_CN.js"></script>
	
	<script src="https://cdn.hcharts.cn/jquery/jquery-1.8.3.min.js"></script>
	
</head>
<title>室内实时位置显示</title>
<body>
<!--
*************************************************************************
   Generated by HCODE at 2018-03-22 15:40:54
   From: https://code.hcharts.cn/demos/KBMsq6
*************************************************************************
 -->
	<div id="container"></div>

	<script>
		// Prepare the data
		/*var data = [],
			n = 10,
			i;
		for (i = 0; i < n; i += 1) {
			data.push([
				Math.pow(Math.random(), 2) * 100,
				Math.pow(Math.random(), 2) * 100
			]);
		}*/
		
		if (!Highcharts.Series.prototype.renderCanvas) {
			throw 'Module not loaded';
		}
		
		function requestData() {
			var x=Math.floor(Math.random()*100),y=Math.floor(Math.random()*100);
			var point=new Array();
			point[0]=x;
			point[1]=y;
			
			alert(point[0]+' '+point[1]);
			
			alert(chart);
			var series = chart.series[0];
			alert(series.data.length);
			shift = series.data.length > 1; // 当数据点数量超过 1 个，则指定删除第一个点
					// 新增点操作
					//Object options, [Boolean redraw], [Boolean shift], [Mixed animation]
					//shift为true则删除数据列第一个点
			alert(series.data.length);
			chart.series[0].addPoint(point, true, shift);
			setTimeout(requestData, 1000);
			/*
			$.ajax({
				url: 'sdfsdf/sdf',
			
				success: function(point) {
					  
					var series = chart.series[0],
						shift = series.data.length > 1; // 当数据点数量超过 1 个，则指定删除第一个点
					// 新增点操作
					//Object options, [Boolean redraw], [Boolean shift], [Mixed animation]
					//shift为true则删除数据列第一个点
					chart.series[0].addPoint(point, true, shift);

					// 一秒后继续调用本函数
					setTimeout(requestData, 1000);
				},
				error: function(XMLRequestObject,errorInfo){
					alert("获取坐标数据失败\r\n"+"原因："+errorInfo);
				},
				cache: false
			});*/
		}
		
		var chart=null;
		$(document).ready(function() {
			alert("enter create chart");
			chart = new Highcharts.Chart({
				chart: {
					renderTo: 'container',
					zoomType: 'xy',
					height: '100%',
					events: {
						load: requestData // 图表加载完毕后执行的回调函数
					}
				},
				boost: {
					useGPUTranslations: true,
					usePreAllocated: true
				},
				xAxis: {
					min: 0,
					max: 100,
					gridLineWidth: 1,
					title: {
						enabled: true,
						text: '<span style="font-size:large;padding-top:auto;">x坐标(单位：)</span>'
					},
					labels: {  
						formatter: function () {  
							return this.value  
						},  
						style: {  
							color: '#000',  
							fontSize:'16px',  
							fontFamily:'微软雅黑'  
						}  
					}     
				},
				yAxis: {
					// Renders faster when we don't have to compute min and max
					min: 0,
					max: 100,
					minPadding: 0,
					maxPadding: 0,
					title: {
						enabled: true,
						text: '<span style="font-size:large;">y坐标(单位：)</span>'
					},
					labels: {  
						formatter: function () {  
							return this.value  
						},  
						style: {  
							color: '#000',  
							fontSize:'16px',  
							fontFamily:'微软雅黑'  
						}  
					}      
				},
				title: {
					text: '室内实时位置显示'
				},
				subtitle:{
					text: '根据计算的x-y坐标显示当前位置'
				},
				legend: {
					enabled: false
				},
				series: [{
					type: 'scatter',
					color: '#36648B',
					data: [],
					name: 'x-y坐标'
					/*marker: {
						radius: 0.1
					},
					tooltip: {
						followPointer: false,
						pointFormat: '[{point.x:.1f}, {point.y:.1f}]'
					}*/
				}]
			});
		
		});
		
		
		
		
</script>
</body>
</html>